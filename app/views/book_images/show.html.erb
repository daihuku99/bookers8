<% if flash[:nitice] %>
	<%= flash[:notice] %>
<% end %>

<div class="container">
	<div class="row">
		<div class="col-xs-3">
			<%= render'book_images/template', book_image_new: @book_image_new, user: @user %>
		</div>
		<div class="col-xs-9">
			<h1>Book detail</h1>
			<table class="table table-striped">
				<thead>
					<tr>
						<th colspan="2"></th>
					</tr>
				</thead>
				<tbody>
					<tr>
						<td>Title</td>
						<td><%= @book_image.title %></td>
					</tr>
					<tr>
						<td>Opinion</td>
						<td><%= @book_image.body %></td>
					</tr>
					<tr>
						<td>Image</td>
						<td><%= attachment_image_tag @book_image, :image, :fill, 60, 60, format: 'jpeg', fallback: 'no_image.jpg' %></td>
					</tr>
				</tbody>
			</table>

			<% if @book_image.favorited_by?(current_user) %>
				<%= link_to book_image_favorites_path(@book_image), method: :delete do %>
				<h5><%= @book_image.favorites.count %>いいね</h5>
				<% end %>
			<% else %>
				<%= link_to book_image_favorites_path(@book_image), method: :post do %>
				<h5><%= @book_image.favorites.count %>いいね</h5>
				<% end %>
			<% end %>

			<h2><%= @book_image.book_comments.count %>件のコメント</h2>
			<% @book_image.book_comments.each do |book_comment| %>
				<%= book_comment.user.name %><br>
				<%= book_comment.created_at.strftime('%Y/%m/%d') %><br>
				<%= book_comment.comment %><br>
			<% end %>
			<%= form_for [@book_image, @book_comment] do |f| %>
				<%= f.text_area :comment, rows:'3' %>
				<%= f.submit 'Create Comment' %>
			<% end %>
			<% if @user.id == current_user.id %>
				<%= link_to 'edit', edit_book_image_path %>
				<%= link_to 'destroy', book_image_path(@book_image.id), method: :delete, "data-confirm" => "Are you sure?" %>
			<% end %>
		</div>
	</div>
</div>